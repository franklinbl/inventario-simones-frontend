import{b as z,d as c,f as $,g as B,j as H,m as J,n as K,o as Q,p as W,q as X,t as Y,v as Z}from"./chunk-SVD2HPHF.js";import{b as G,m as q,n as R}from"./chunk-YZRHWAFK.js";import{$ as T,Bc as D,Db as A,Fb as g,G as P,Gb as m,Rb as r,Sb as _,Ta as o,Tb as v,W as I,Xb as k,Ya as F,Zb as w,db as V,ga as f,ha as x,hb as u,ob as b,qb as C,tb as p,vb as N,wb as L,xb as n,yb as t,yc as j,zb as h}from"./chunk-SHGEUKQA.js";var O=class i{constructor(a){this.http=a}API_URL=`${R.apiUrl}/auth`;getUsers(){return this.http.get(`${this.API_URL}/users`)}createUser(a){return this.http.post(`${this.API_URL}/register`,a)}static \u0275fac=function(e){return new(e||i)(T(G))};static \u0275prov=I({token:i,factory:i.\u0275fac,providedIn:"root"})};var ie=(i,a)=>a.id;function re(i,a){i&1&&(n(0,"div",3)(1,"div",7)(2,"span",8),r(3,"Cargando..."),t()()())}function oe(i,a){if(i&1&&(n(0,"div",4),r(1),t()),i&2){let e=m();o(),v(" ",e.errorMessage," ")}}function ae(i,a){if(i&1&&(n(0,"tr")(1,"td"),r(2),t(),n(3,"td"),r(4),t(),n(5,"td"),r(6),t(),n(7,"td"),r(8),k(9,"date"),t(),n(10,"td"),r(11),k(12,"date"),t(),n(13,"td")(14,"button",10),r(15," Editar "),t()()()),i&2){let e=a.$implicit;o(2),_(e.name),o(2),_(e.username),o(2),_(e.role.name),o(2),_(w(9,5,e.createdAt,"dd/MM/yyyy")),o(3),_(w(12,8,e.updatedAt,"dd/MM/yyyy"))}}function le(i,a){if(i&1&&(n(0,"div",5)(1,"table",9)(2,"thead")(3,"tr")(4,"th"),r(5,"Nombre"),t(),n(6,"th"),r(7,"Usuario"),t(),n(8,"th"),r(9,"Rol"),t(),n(10,"th"),r(11,"Fecha de Creaci\xF3n"),t(),n(12,"th"),r(13,"\xDAltima Actualizaci\xF3n"),t(),h(14,"th"),t()(),n(15,"tbody"),N(16,ae,16,11,"tr",null,ie),t()()()),i&2){let e=m();o(16),L(e.users)}}function se(i,a){if(i&1&&(n(0,"div",20),r(1),t()),i&2){let e=m(2);o(),v(" ",e.getErrorMessage("name")," ")}}function de(i,a){if(i&1&&(n(0,"div",20),r(1),t()),i&2){let e=m(2);o(),v(" ",e.getErrorMessage("username")," ")}}function me(i,a){if(i&1&&(n(0,"div",20),r(1),t()),i&2){let e=m(2);o(),v(" ",e.getErrorMessage("password")," ")}}function ce(i,a){if(i&1&&(n(0,"div",20),r(1),t()),i&2){let e=m(2);o(),v(" ",e.getErrorMessage("roleId")," ")}}function ue(i,a){if(i&1){let e=A();n(0,"div",11),g("click",function(){f(e);let s=m();return x(s.closeModal())}),n(1,"div",12),g("click",function(s){return f(e),x(s.stopPropagation())}),n(2,"div",13)(3,"h3"),r(4),t(),n(5,"button",14),g("click",function(){f(e);let s=m();return x(s.closeModal())}),r(6,"\xD7"),t()(),n(7,"div",15)(8,"form",16),g("ngSubmit",function(){f(e);let s=m();return x(s.onSubmit())}),n(9,"div",17)(10,"label",18),r(11,"Nombre"),t(),h(12,"input",19),u(13,se,2,1,"div",20),t(),n(14,"div",17)(15,"label",21),r(16,"Usuario"),t(),h(17,"input",22),u(18,de,2,1,"div",20),t(),n(19,"div",17)(20,"label",23),r(21,"Contrase\xF1a"),t(),h(22,"input",24),u(23,me,2,1,"div",20),t(),n(24,"div",17)(25,"label",25),r(26,"Rol"),t(),n(27,"select",26)(28,"option",27),r(29,"Administrador"),t(),n(30,"option",27),r(31,"Empleado"),t()(),u(32,ce,2,1,"div",20),t(),n(33,"div",28)(34,"button",29),g("click",function(){f(e);let s=m();return x(s.closeModal())}),r(35,"Cancelar"),t(),n(36,"button",30),r(37," Guardar "),t()()()()()()}if(i&2){let e,d,s,M,y,E,S,U,l=m();o(4),_(l.modalTitle),o(4),b("formGroup",l.userForm),o(4),C("is-invalid",((e=l.userForm.get("name"))==null?null:e.invalid)&&((e=l.userForm.get("name"))==null?null:e.touched)),o(),p((d=l.userForm.get("name"))!=null&&d.invalid&&((d=l.userForm.get("name"))!=null&&d.touched)?13:-1),o(4),C("is-invalid",((s=l.userForm.get("username"))==null?null:s.invalid)&&((s=l.userForm.get("username"))==null?null:s.touched)),o(),p((M=l.userForm.get("username"))!=null&&M.invalid&&((M=l.userForm.get("username"))!=null&&M.touched)?18:-1),o(4),C("is-invalid",((y=l.userForm.get("password"))==null?null:y.invalid)&&((y=l.userForm.get("password"))==null?null:y.touched)),o(),p((E=l.userForm.get("password"))!=null&&E.invalid&&((E=l.userForm.get("password"))!=null&&E.touched)?23:-1),o(4),C("is-invalid",((S=l.userForm.get("roleId"))==null?null:S.invalid)&&((S=l.userForm.get("roleId"))==null?null:S.touched)),o(),b("ngValue",1),o(2),b("ngValue",2),o(2),p((U=l.userForm.get("roleId"))!=null&&U.invalid&&((U=l.userForm.get("roleId"))!=null&&U.touched)?32:-1),o(4),b("disabled",l.userForm.invalid)}}var ee=class i{constructor(a,e){this.userService=a;this.fb=e;this.userForm=this.fb.group({name:["",[c.required,c.minLength(3)]],username:["",[c.required,c.minLength(3)]],password:["",[c.required,c.minLength(6)]],roleId:[null,c.required]})}users=[];isLoading=!1;errorMessage="";isModalOpen=!1;modalTitle="Nuevo Usuario";userForm;ngOnInit(){this.loadUsers()}loadUsers(){this.isLoading=!0,this.errorMessage="",this.userService.getUsers().pipe(P(()=>this.isLoading=!1)).subscribe({next:a=>{this.users=a},error:a=>{console.error("Error loading users:",a),this.errorMessage="Error al cargar los usuarios"}})}openModal(){this.isModalOpen=!0,this.userForm.reset({roleId:1})}closeModal(){this.isModalOpen=!1,this.userForm.reset()}onSubmit(){this.userForm.valid&&(this.isLoading=!0,this.userService.createUser(this.userForm.value).pipe(P(()=>{this.isLoading=!1,this.closeModal()})).subscribe({next:()=>{this.loadUsers()},error:a=>{console.error("Error creating user:",a),this.errorMessage="Error al crear el usuario"}}))}getErrorMessage(a){let e=this.userForm.get(a);return e?.hasError("required")?"Este campo es requerido":e?.hasError("minlength")?`M\xEDnimo ${e.getError("minlength").requiredLength} caracteres`:""}static \u0275fac=function(e){return new(e||i)(F(O),F(Y))};static \u0275cmp=V({type:i,selectors:[["app-users"]],decls:11,vars:2,consts:[[1,"users-container"],[1,"header"],[1,"primary-button",3,"click"],[1,"loading-spinner"],["role","alert",1,"alert","alert-danger"],[1,"table-responsive"],[1,"modal-overlay"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"table"],[1,"edit-button"],[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"modal-header"],[1,"close-button",3,"click"],[1,"modal-body"],[1,"user-form",3,"ngSubmit","formGroup"],[1,"form-group"],["for","name"],["type","text","id","name","formControlName","name",1,"form-control"],[1,"error-message"],["for","username"],["type","text","id","username","formControlName","username",1,"form-control"],["for","password"],["type","password","id","password","formControlName","password",1,"form-control"],["for","roleId"],["id","roleId","formControlName","roleId",1,"form-control"],[3,"ngValue"],[1,"form-actions"],["type","button",1,"secondary-button",3,"click"],["type","submit",1,"primary-button",3,"disabled"]],template:function(e,d){e&1&&(n(0,"div",0)(1,"div",1)(2,"h1"),r(3,"Gesti\xF3n de Usuarios"),t(),n(4,"button",2),g("click",function(){return d.openModal()}),r(5," Nuevo Usuario "),t()(),n(6,"div"),u(7,re,4,0,"div",3)(8,oe,2,1,"div",4)(9,le,18,0,"div",5),t()(),u(10,ue,38,17,"div",6)),e&2&&(o(7),p(d.isLoading?7:d.errorMessage?8:9),o(3),p(d.isModalOpen?10:-1))},dependencies:[D,j,q,Z,H,W,X,z,Q,$,B,J,K],styles:[".users-container[_ngcontent-%COMP%]{padding:20px}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}h1[_ngcontent-%COMP%]{margin:0;color:#333}.primary-button[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;border:none;padding:8px 16px;border-radius:4px;cursor:pointer;transition:background-color .2s}.primary-button[_ngcontent-%COMP%]:hover{background-color:#0056b3}.primary-button[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed}.secondary-button[_ngcontent-%COMP%]{background-color:#6c757d;color:#fff;border:none;padding:8px 16px;border-radius:4px;cursor:pointer;transition:background-color .2s}.secondary-button[_ngcontent-%COMP%]:hover{background-color:#5a6268}.loading-spinner[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:200px}.table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-bottom:1rem;background-color:transparent}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f8f9fa;border-bottom:2px solid #dee2e6;padding:12px;text-align:left;font-weight:600;color:#333}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px;vertical-align:middle;border-bottom:1px solid #dee2e6}.table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f8f9fa}.edit-button[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;border:none;padding:6px 12px;border-radius:4px;cursor:pointer;transition:background-color .2s}.edit-button[_ngcontent-%COMP%]:hover{background-color:#0056b3}.alert[_ngcontent-%COMP%]{margin-bottom:0}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#00000080;display:flex;justify-content:center;align-items:center;z-index:1000}.modal-content[_ngcontent-%COMP%]{background:#fff;padding:20px;border-radius:8px;width:100%;max-width:500px;max-height:90vh;overflow-y:auto}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0}.close-button[_ngcontent-%COMP%]{background:none;border:none;font-size:24px;cursor:pointer;color:#666}.form-group[_ngcontent-%COMP%]{margin-bottom:15px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:5px;font-weight:500}.form-control[_ngcontent-%COMP%]{width:100%;padding:8px;border:1px solid #ddd;border-radius:4px;font-size:14px}.form-control.is-invalid[_ngcontent-%COMP%]{border-color:#dc3545}.error-message[_ngcontent-%COMP%]{color:#dc3545;font-size:12px;margin-top:5px}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:10px;margin-top:20px}"]})};export{ee as UsersComponent};
