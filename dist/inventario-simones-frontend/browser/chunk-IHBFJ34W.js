import{a as W}from"./chunk-L2ILWYKD.js";import{a as j}from"./chunk-DJDQRREY.js";import{b as $,d as f,f as B,g as R,j as L,k as H,m as U,n as J,t as K,v as Q}from"./chunk-SVD2HPHF.js";import{e as G}from"./chunk-YZRHWAFK.js";import{Ac as z,Bc as D,Db as M,Fb as b,Gb as s,Rb as l,Sb as h,Ta as a,Tb as v,Xb as N,Yb as A,aa as F,db as T,ga as m,ha as g,hb as _,ob as y,qb as C,tb as x,ub as w,vb as V,wb as q,xb as o,yb as n,zb as P}from"./chunk-SHGEUKQA.js";function Y(r,e){if(r&1){let t=M();o(0,"button",7),b("click",function(){m(t);let i=s();return g(i.openModal())}),l(1," Nuevo Producto "),n()}}function Z(r,e){r&1&&P(0,"th")}function tt(r,e){if(r&1){let t=M();o(0,"td")(1,"button",8),b("click",function(){m(t);let i=s().$implicit,p=s();return g(p.openModal(i))}),l(2," Editar "),n()()}}function et(r,e){if(r&1&&(o(0,"tr")(1,"td"),l(2),n(),o(3,"td"),l(4),n(),o(5,"td"),l(6),N(7,"currency"),n(),o(8,"td"),l(9),n(),o(10,"td"),l(11),n(),_(12,tt,3,0,"td"),n()),r&2){let t=e.$implicit,c=s();a(2),h(t.name),a(2),h(t.description),a(2),h(A(7,6,t.price)),a(3),h(t.total_quantity),a(2),h(t.available_quantity),a(),x(c.isAdmin?12:-1)}}function nt(r,e){if(r&1){let t=M();o(0,"button",12),b("click",function(){let i=m(t).$implicit,p=s(2);return g(i!==-1&&p.changePage(i))}),l(1),n()}if(r&2){let t=e.$implicit,c=s(2);C("active",t===c.currentPage)("ellipsis",t===-1),y("disabled",t===-1),a(),v(" ",t===-1?"...":t," ")}}function it(r,e){if(r&1){let t=M();o(0,"div",5)(1,"button",9),b("click",function(){m(t);let i=s();return g(i.changePage(i.currentPage-1))}),l(2," Anterior "),n(),o(3,"div",10),V(4,nt,2,6,"button",11,w),n(),o(6,"button",9),b("click",function(){m(t);let i=s();return g(i.changePage(i.currentPage+1))}),l(7," Siguiente "),n()()}if(r&2){let t=s();a(),y("disabled",!t.hasPreviousPage),a(3),q(t.getPages()),a(2),y("disabled",!t.hasNextPage)}}function ot(r,e){if(r&1&&(o(0,"div",22),l(1),n()),r&2){let t=s(2);a(),v(" ",t.getErrorMessage("name")," ")}}function rt(r,e){if(r&1&&(o(0,"div",22),l(1),n()),r&2){let t=s(2);a(),v(" ",t.getErrorMessage("description")," ")}}function at(r,e){if(r&1&&(o(0,"div",22),l(1),n()),r&2){let t=s(2);a(),v(" ",t.getErrorMessage("price")," ")}}function lt(r,e){if(r&1&&(o(0,"div",22),l(1),n()),r&2){let t=s(2);a(),v(" ",t.getErrorMessage("total_quantity")," ")}}function ct(r,e){if(r&1&&(o(0,"div",22),l(1),n()),r&2){let t=s(2);a(),v(" ",t.getErrorMessage("available_quantity")," ")}}function dt(r,e){if(r&1){let t=M();o(0,"div",13),b("click",function(){m(t);let i=s();return g(i.closeModal())}),o(1,"div",14),b("click",function(i){return m(t),g(i.stopPropagation())}),o(2,"div",15)(3,"h3"),l(4),n(),o(5,"button",16),b("click",function(){m(t);let i=s();return g(i.closeModal())}),l(6,"\xD7"),n()(),o(7,"div",17)(8,"form",18),b("ngSubmit",function(){m(t);let i=s();return g(i.onSubmit())}),o(9,"div",19)(10,"label",20),l(11,"Nombre"),n(),P(12,"input",21),_(13,ot,2,1,"div",22),n(),o(14,"div",19)(15,"label",23),l(16,"Descripci\xF3n"),n(),P(17,"textarea",24),_(18,rt,2,1,"div",22),n(),o(19,"div",19)(20,"label",25),l(21,"Precio"),n(),P(22,"input",26),_(23,at,2,1,"div",22),n(),o(24,"div",19)(25,"label",27),l(26,"Cantidad Total"),n(),P(27,"input",28),_(28,lt,2,1,"div",22),n(),o(29,"div",19)(30,"label",29),l(31,"Cantidad Disponible"),n(),P(32,"input",30),_(33,ct,2,1,"div",22),n(),o(34,"div",31)(35,"button",32),b("click",function(){m(t);let i=s();return g(i.closeModal())}),l(36,"Cancelar"),n(),o(37,"button",33),l(38),n()()()()()()}if(r&2){let t,c,i,p,u,O,I,E,k,S,d=s();a(4),h(d.modalTitle),a(4),y("formGroup",d.productForm),a(4),C("is-invalid",((t=d.productForm.get("name"))==null?null:t.invalid)&&((t=d.productForm.get("name"))==null?null:t.touched)),a(),x((c=d.productForm.get("name"))!=null&&c.invalid&&((c=d.productForm.get("name"))!=null&&c.touched)?13:-1),a(4),C("is-invalid",((i=d.productForm.get("description"))==null?null:i.invalid)&&((i=d.productForm.get("description"))==null?null:i.touched)),a(),x((p=d.productForm.get("description"))!=null&&p.invalid&&((p=d.productForm.get("description"))!=null&&p.touched)?18:-1),a(4),C("is-invalid",((u=d.productForm.get("price"))==null?null:u.invalid)&&((u=d.productForm.get("price"))==null?null:u.touched)),a(),x((O=d.productForm.get("price"))!=null&&O.invalid&&((O=d.productForm.get("price"))!=null&&O.touched)?23:-1),a(4),C("is-invalid",((I=d.productForm.get("total_quantity"))==null?null:I.invalid)&&((I=d.productForm.get("total_quantity"))==null?null:I.touched)),a(),x((E=d.productForm.get("total_quantity"))!=null&&E.invalid&&((E=d.productForm.get("total_quantity"))!=null&&E.touched)?28:-1),a(4),C("is-invalid",((k=d.productForm.get("available_quantity"))==null?null:k.invalid)&&((k=d.productForm.get("available_quantity"))==null?null:k.touched)),a(),x((S=d.productForm.get("available_quantity"))!=null&&S.invalid&&((S=d.productForm.get("available_quantity"))!=null&&S.touched)?33:-1),a(4),y("disabled",d.productForm.invalid),a(),v(" ",d.editingProductId?"Actualizar":"Guardar"," ")}}var X=class r{inventoryService=F(W);fb=F(K);authService=F(j);isAdmin=!1;products=[];isModalOpen=!1;productForm;editingProductId=null;currentPage=1;totalPages=1;totalItems=0;itemsPerPage=0;hasNextPage=!1;hasPreviousPage=!1;constructor(){this.productForm=this.fb.group({name:["",[f.required,f.minLength(3)]],description:[""],total_quantity:[null,[f.required,f.min(0)]],available_quantity:[null,[f.required,f.min(0)]],price:[null,[f.required,f.min(0)]]})}ngOnInit(){this.loadProducts();let e=this.authService.getCurrentUser();this.isAdmin=e?.role.name==="Administrador"}loadProducts(e=1){this.inventoryService.getProducts(e,20).subscribe({next:t=>{this.products=t.products,this.currentPage=t.pagination.currentPage,this.totalPages=t.pagination.totalPages,this.totalItems=t.pagination.total,this.itemsPerPage=t.pagination.limit,this.hasNextPage=t.pagination.hasNextPage,this.hasPreviousPage=t.pagination.hasPreviousPage},error:t=>{console.error("Error al cargar productos:",t)}})}changePage(e){e>=1&&e<=this.totalPages&&this.loadProducts(e)}getPages(){let e=[],c=Math.floor(3.5);if(this.totalPages<=7){for(let u=1;u<=this.totalPages;u++)e.push(u);return e}let i=Math.max(1,this.currentPage-c),p=Math.min(this.totalPages,i+7-1);p-i+1<7&&(i=Math.max(1,p-7+1)),i>1&&(e.push(1),i>2&&e.push(-1));for(let u=i;u<=p;u++)e.push(u);return p<this.totalPages&&(p<this.totalPages-1&&e.push(-1),e.push(this.totalPages)),e}openModal(e){e?(this.editingProductId=e.id,this.productForm.patchValue({name:e.name,description:e.description,total_quantity:e.total_quantity,available_quantity:e.available_quantity,price:e.price})):(this.editingProductId=null,this.productForm.reset()),this.isModalOpen=!0}closeModal(){this.isModalOpen=!1,this.editingProductId=null,this.productForm.reset()}onSubmit(){if(this.productForm.valid){let e=this.productForm.value;this.editingProductId?this.inventoryService.updateProduct(this.editingProductId,e).subscribe({next:t=>{let c=this.products.findIndex(i=>i.id===this.editingProductId);c!==-1&&(this.products[c]=t),this.closeModal()},error:t=>{console.error("Error al actualizar producto:",t)}}):this.inventoryService.createProduct(e).subscribe({next:t=>{this.products.push(t.product),this.closeModal()},error:t=>{console.error("Error al crear producto:",t)}})}}getErrorMessage(e){let t=this.productForm.get(e);return t?.hasError("required")?"Este campo es requerido":t?.hasError("minlength")?`M\xEDnimo ${t.errors?.minlength.requiredLength} caracteres`:t?.hasError("min")?"El valor debe ser mayor o igual a 0":""}get modalTitle(){return this.editingProductId?"Editar Producto":"Nuevo Producto"}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=T({type:r,selectors:[["app-inventory"]],decls:25,vars:4,consts:[[1,"container"],[1,"header"],[1,"primary-button"],[1,"table-responsive"],[1,"table"],[1,"pagination"],[1,"modal-overlay"],[1,"primary-button",3,"click"],[1,"edit-button",3,"click"],[1,"pagination-button",3,"click","disabled"],[1,"page-numbers"],[1,"page-number",3,"active","ellipsis","disabled"],[1,"page-number",3,"click","disabled"],[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"modal-header"],[1,"close-button",3,"click"],[1,"modal-body"],[1,"product-form",3,"ngSubmit","formGroup"],[1,"form-group"],["for","name"],["type","text","id","name","formControlName","name",1,"form-control"],[1,"error-message"],["for","description"],["id","description","formControlName","description",1,"form-control"],["for","price"],["type","number","id","price","formControlName","price","placeholder","0",1,"form-control"],["for","total_quantity"],["type","number","id","total_quantity","formControlName","total_quantity","placeholder","0",1,"form-control"],["for","available_quantity"],["type","number","id","available_quantity","formControlName","available_quantity","placeholder","0",1,"form-control"],[1,"form-actions"],["type","button",1,"secondary-button",3,"click"],["type","submit",1,"primary-button",3,"disabled"]],template:function(t,c){t&1&&(o(0,"div",0)(1,"div",1)(2,"h2"),l(3,"Inventario de Productos"),n(),_(4,Y,2,0,"button",2),n(),o(5,"div",3)(6,"table",4)(7,"thead")(8,"tr")(9,"th"),l(10,"Nombre"),n(),o(11,"th"),l(12,"Descripci\xF3n"),n(),o(13,"th"),l(14,"Precio"),n(),o(15,"th"),l(16,"Cantidad Total"),n(),o(17,"th"),l(18,"Cantidad Disponible"),n(),_(19,Z,1,0,"th"),n()(),o(20,"tbody"),V(21,et,13,8,"tr",null,w),n()(),_(23,it,8,2,"div",5),n()(),_(24,dt,39,19,"div",6)),t&2&&(a(4),x(c.isAdmin?4:-1),a(15),x(c.isAdmin?19:-1),a(2),q(c.products),a(2),x(c.totalPages>1?23:-1),a(),x(c.isModalOpen?24:-1))},dependencies:[D,z,G,Q,L,$,H,B,R,U,J],styles:["[_ngcontent-%COMP%]:export{primaryColor:#1976d2;secondaryColor:#424242;accentColor:#ff4081}.inventory-container[_ngcontent-%COMP%]{padding:24px}h1[_ngcontent-%COMP%]{margin-bottom:24px;color:#000000de}.content[_ngcontent-%COMP%]{background-color:#fff;padding:24px;border-radius:8px;box-shadow:0 2px 4px #0000001a}.container[_ngcontent-%COMP%]{padding:20px}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.primary-button[_ngcontent-%COMP%]{padding:8px 16px;background-color:#1976d2;color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:14px;transition:background-color .2s}.primary-button[_ngcontent-%COMP%]:hover{background-color:#1565c0}.primary-button[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed}.secondary-button[_ngcontent-%COMP%]{padding:8px 16px;background-color:#f5f5f5;color:#333;border:1px solid #ddd;border-radius:4px;cursor:pointer;font-size:14px;transition:background-color .2s}.secondary-button[_ngcontent-%COMP%]:hover{background-color:#e0e0e0}.table-responsive[_ngcontent-%COMP%]{margin-top:20px;overflow-x:auto}.table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;background-color:#fff;box-shadow:0 1px 3px #0000001a}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px;text-align:left;border-bottom:1px solid #ddd}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f5f5f5;font-weight:700;color:#333}.table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{transition:background-color .2s ease}.table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f9f9f9}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:#666}h2[_ngcontent-%COMP%]{color:#333;font-size:24px;margin:0}h3[_ngcontent-%COMP%]{color:#666;font-size:18px;margin-bottom:15px}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#00000080;display:flex;justify-content:center;align-items:center;z-index:1000}.modal-content[_ngcontent-%COMP%]{background-color:#fff;border-radius:8px;width:90%;max-width:600px;max-height:90vh;overflow-y:auto;position:relative}.modal-header[_ngcontent-%COMP%]{padding:16px 24px;border-bottom:1px solid #eee;display:flex;justify-content:space-between;align-items:center}.modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#333}.modal-body[_ngcontent-%COMP%]{padding:24px}.close-button[_ngcontent-%COMP%]{background:none;border:none;font-size:24px;cursor:pointer;color:#666;padding:0;line-height:1}.close-button[_ngcontent-%COMP%]:hover{color:#333}.product-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;color:#333}.form-control[_ngcontent-%COMP%]{padding:8px 12px;border:1px solid #ddd;border-radius:4px;font-size:14px;transition:border-color .2s}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#1976d2}.form-control.is-invalid[_ngcontent-%COMP%]{border-color:#dc3545}textarea.form-control[_ngcontent-%COMP%]{min-height:100px;resize:vertical}.error-message[_ngcontent-%COMP%]{color:#dc3545;font-size:12px;margin-top:4px}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:12px;margin-top:20px}.edit-button[_ngcontent-%COMP%]{padding:6px 12px;background-color:#2196f3;color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:14px;transition:background-color .2s}.edit-button[_ngcontent-%COMP%]:hover{background-color:#1976d2}.pagination[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;gap:10px;margin-top:20px;padding:10px}.pagination[_ngcontent-%COMP%]   .pagination-button[_ngcontent-%COMP%]{padding:8px 16px;background-color:#f5f5f5;border:1px solid #ddd;border-radius:4px;cursor:pointer;transition:background-color .2s}.pagination[_ngcontent-%COMP%]   .pagination-button[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#e0e0e0}.pagination[_ngcontent-%COMP%]   .pagination-button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.pagination[_ngcontent-%COMP%]   .page-numbers[_ngcontent-%COMP%]{display:flex;gap:5px}.pagination[_ngcontent-%COMP%]   .page-number[_ngcontent-%COMP%]{padding:8px 12px;background-color:#f5f5f5;border:1px solid #ddd;border-radius:4px;cursor:pointer;transition:all .2s}.pagination[_ngcontent-%COMP%]   .page-number[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#e0e0e0}.pagination[_ngcontent-%COMP%]   .page-number.active[_ngcontent-%COMP%]{background-color:#1976d2;color:#fff;border-color:#1976d2}.pagination[_ngcontent-%COMP%]   .page-number.ellipsis[_ngcontent-%COMP%]{background:none;border:none;cursor:default;padding:8px 4px}.pagination[_ngcontent-%COMP%]   .page-number[_ngcontent-%COMP%]:disabled{opacity:1;cursor:default}"]})};export{X as InventoryComponent};
